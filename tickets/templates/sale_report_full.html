<!DOCTYPE html>

{% load mathfilters %}
<html>
<head>
	{% include 'favicon.html' %}
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>NT Tickets</title>
	<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="{{ STATIC_URL }}stylesheets/materialize.css" rel="stylesheet" />
	<link href="{{ STATIC_URL }}stylesheets/style.css" rel="stylesheet" />
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}js/bin/materialize.js"></script>
</head>
<body id="background">
	<header>
		<div class="navbar-fixed">
			<nav>
			    <div class="nav-wrapper">
			     	<a href="/" class="brand-logo center">
			     	<img src="{{ STATIC_URL }}images/nnt_tickets_white.png" id="nav-logo">
			     	</a>
			     	<div class="nav-container">
				     	<ul id="nav-mobile" class="left hide-on-med-and-down">
				        	<li><a href="/">Home</a></li>
				        	<li><a href="/report">Sale Reports</a></li>
				      	</ul>
				      	<ul id="nav-mobile" class="right hide-on-med-and-down">
				      		<li><a href="/admin">Admin Login</a></li>
				      	</ul>
			      	</div>
			    </div>
			</nav>
		</div>
	</header>
	<main>
	<div class="container">
		<div class="row">
			<div class="col s12">
				<div class="card small grey darken-3">
					<div class="row">
						<div class="col s2">
							<div class="card-image">
								<a href="/report/" rel="nofollow">
								{% if show.poster_page %}
									<img class="responsive-img" src="{{ show.poster_page.url }}" id="report-image">
								{% else %}
									<img class="responsive-img" src="{{ STATIC_URL }}images/no_image.png" id="report-image">
								{% endif %}
								</a>
							</div>
						</div>
						<div class="col s10">
							<div class="card-content">
								<span class="card-title light white-text">
								{{ show.name }}
								</span>

								<div class="row">
									<div class="col s9">
										<div class="col s12">
											<span class="nnt-orange sale-text truncate">Total Sales: 
											<span class="bold">£{{ show.show_sales }}</span>
											</span>
										</div>
										<div class="col s12">
											<span class="nnt-purple sale-text truncate">Total Tickets Sold: 
											<span class="bold">{{ show.total_tickets_sold_show }}</span>
											</span>
										</div>
										<div class="col s12">
											<span class="nnt-orange sale-text truncate">
											Total Tickets Reserved: <span class="bold">{{ show.total_tickets_reserved }}</span>

											(out of a possible of: <span class="bold">{{ show.total_possible }})</span>
											</span>
										</div>
									</div>
									<div class="col s3">
										<button class="btn nnt purple waves-effect waves-dark">Download Report</button>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

				{% for oc in occurrence %}
				<div class="row">

					<div class="col s12" id="form-background">
					<div class="sale-container">
							<div class="col s12 center-align">
								<span class="light nnt-orange report-text bold">
								{{ oc.day_formatted }} at {{ oc.time_formatted }}
								</span>
							</div>
							{% if show.category|stringformat:"s" == "In House" %}
							<div class="col s12 center-align">
								<table class="centered">
									<thead>
										<tr>
											<th class="nnt-purple bold">Concession Tickets</th>
											<th class="nnt-purple bold">Public Tickets</th>
											<th class="nnt-purple bold">Season Tickets</th>
											<th class="nnt-purple bold">Fellow Tickets</th>
											{% if oc.time_formatted|stringformat:"s" == report.default_time_matinee %}
											<th class="nnt-purple bold">Matinee Freshers Tickets</th>
											<th class="nnt-purple bold">Matinee NNT Freshers Tickets</th>
											{% endif %}
										</tr>
									</thead>
									<tbody>
										<tr>
											<td class="nnt-orange bold">{{ oc.concession_tally }}</td>
											<td class="nnt-orange bold">{{ oc.public_tally }}</td>
											<td class="nnt-orange bold">{{ oc.season_tally }}</td>
											<td class="nnt-orange bold">{{ oc.fellow_tally }}</td>
											{% if oc.time_formatted|stringformat:"s" == report.default_time_matinee %}
											<td class="nnt-orange bold">{{ oc.matinee_freshers_tally }}</td>
											<td class="nnt-orange bold">{{ oc.matinee_freshers_nnt_tally }}</td>
											{% endif %}
										</tr>
										<tr>
											<td class="nnt-orange bold">£{{ oc.concession_tally|mul:report.concession_price }}</td>
											<td class="nnt-orange bold">£{{ oc.public_tally|mul:report.public_price }}</td>
											<td class="nnt-orange bold">£{{ oc.season_tally|mul:0 }}</td>
											<td class="nnt-orange bold">£{{ oc.fellow_tally|mul:0 }}</td>
											{% if oc.time_formatted|stringformat:"s" == report.default_time_matinee %}
											<td class="nnt-orange bold">£{{ oc.matinee_freshers_tally|mul:report.matinee_freshers_price }}</td>
											<td class="nnt-orange bold">£{{ oc.matinee_freshers_nnt_tally|mul:report.matinee_freshers_nnt_price }}</td>
											{% endif %}
										</tr>
									</tbody>
								</table>
							</div>
							{% elif show.category|stringformat:"s" == "Fringe" %}
								<div class="col s12 center-align">
								<table class="centered">
									<thead>
										<tr>
											<th class="nnt-purple bold">Fringe Tickets</th>
											<th class="nnt-purple bold">Season Tickets</th>
											<th class="nnt-purple bold">Fellow Tickets</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td class="nnt-orange bold">{{ oc.fringe_tally }}</td>
											<td class="nnt-orange bold">{{ oc.season_tally }}</td>
											<td class="nnt-orange bold">{{ oc.fellow_tally }}</td>
										</tr>
										<tr>
											<td class="nnt-orange bold">£{{ oc.fringe_tally|mul:report.fringe_price }}</td>
											<td class="nnt-orange bold">£{{ oc.season_tally|mul:0 }}</td>
											<td class="nnt-orange bold">£{{ oc.fellow_tally|mul:0 }}</td>
										</tr>
									</tbody>
								</table>
							</div>
							{% elif show.category|stringformat:"s" == "External" %}
								<p>External</p>
							{% else %}
								<p class="light red-text center-align report-text">Invalid category applied ({{ show.category }})</p>
							{% endif %}
							<div class="col s12 center-align">
								<div class="col s6">
									<span class="nnt-orange bold small-text">Total tickets:
									<span class="nnt-orange bold small-text">{{ oc.sales }}</span>
									</span>
								</div>
								<div class="col s6">
									<span class="nnt-orange bold small-text">Total sales:
									<span class="nnt-orange bold small-text">£{{ oc.total_sales }}</span>
									</span>
								</div>
							</div>
							<div class="col s12"><br></div>
						</div>
					</div>
				</div>
				{% endfor %}
			</div>
		</div>
	</div>
	</main>
</head>
</html>

